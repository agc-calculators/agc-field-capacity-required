/*! Built with http://stenciljs.com */
const{h:t}=window.AgcFieldCapacityRequired,e=(t,e)=>{let a=t.querySelector(`[name="${e}"]`),s=t.querySelector(`[data-validates="${e}"`);return a.checkValidity()?(a.className=a.className.replace(" invalid",""),s.style.display="none",!0):(-1===a.className.indexOf("invalid")&&(a.className+=" invalid"),s.style.display="block",!1)},a=(t,e)=>+(Math.round(new Number(`${t}e+${e}`).valueOf())+"e-"+e);class s{constructor(){this.socket="",this.tract="",this.mode="step",this.units={land:"A"},this.currentStep=0,this.cache={},this.submitted=!1,this.results={}}render(){return t("div",null,t("form",{onSubmit:t=>t.preventDefault(),ref:t=>this.form=t,"data-wizard":"agc-field-capacity-required","data-wizard-mode":this.mode,class:"agc-wizard"},t("slot",null),t("section",{"data-wizard-section":"1"},t("div",{class:"agc-wizard__field"},t("label",{"data-i18n":`fields.land-to-work.${this.units.land}`},"Total Land to Work"),t("input",{name:"landToWork",type:"number",min:"0",step:".01",required:!0}),t("p",{class:"agc-wizard__validation-message","data-i18n":"validation.land-to-work.required","data-validates":"landToWork"},"Please enter a value."),t("p",{"data-i18n":"hints.land-to-work"},"â®¤ Enter the total acres of land that will be worked.")),t("div",{class:"agc-wizard__actions"},"step"===this.mode&&t("button",{class:"agc-wizard__actions-next","data-i18n":"actions.next",onClick:this.nextPrev.bind(this,1)},"Next ðŸ –"))),t("section",{"data-wizard-section":"2"},t("div",{class:"agc-wizard__field"},t("label",{"data-i18n":"fields.days-to-work"},"Total Days to Work"),t("input",{name:"daysToWork",type:"number",min:"0",step:"1",required:!0}),t("p",{class:"agc-wizard__validation-message","data-i18n":"validation.days-to-work.required","data-validates":"daysToWork"},"Please enter a whole number of zero or more."),t("p",{"data-i18n":"hints.days-to-work"},"â®¤ Enter the desired number of days available to work the field.")),t("div",{class:"agc-wizard__actions"},"step"===this.mode&&[t("button",{class:"agc-wizard__actions-prev","data-i18n":"actions.prev",onClick:this.nextPrev.bind(this,-1)},"ðŸ ” Back"),t("button",{class:"agc-wizard__actions-next","data-i18n":"actions.next",onClick:this.nextPrev.bind(this,1)},"Next ðŸ –")])),t("section",{"data-wizard-section":"3"},t("div",{class:"agc-wizard__field"},t("label",{"data-i18n":"fields.hours-per-day"},"Total Hours per Day"),t("input",{name:"hoursPerDay",type:"number",min:"1",step:"1",required:!0}),t("p",{class:"agc-wizard__validation-message","data-i18n":"validation.hours-per-day.required","data-validates":"hoursPerDay"},"Please enter a whole number greater than zero."),t("p",{"data-i18n":"hints.hours-per-day"},"â®¤ Enter the total number of hours available each day.")),t("div",{class:"agc-wizard__actions"},"step"===this.mode&&t("button",{class:"agc-wizard__actions-prev","data-i18n":"actions.prev",onClick:this.nextPrev.bind(this,-1)},"ðŸ ” Back"),t("button",{class:"agc-wizard__actions-next","data-i18n":"actions.finish",onClick:this.nextPrev.bind(this,"step"===this.mode?1:3)},"Calculate ðŸ –"))),t("section",{"data-wizard-results":!0},t("slot",{name:"results"}))))}showTab(t){"step"===this.mode&&(this.cache.sections[t].style.display="block"),this.socket&&this.agcStepChanged.emit({socket:this.socket,tract:this.tract,step:this.currentStep})}reset(){this.currentStep=0,this.submitted=!1,this.showTab(0)}validateForm(){let t=!0;return 0!==this.currentStep&&"full"!==this.mode||e(this.form,"landToWork")||(t=!1),1!==this.currentStep&&"full"!==this.mode||e(this.form,"daysToWork")||(t=!1),2!==this.currentStep&&"full"!==this.mode||e(this.form,"hoursPerDay")||(t=!1),t}nextPrev(t,e){if(e&&e.preventDefault(),"full"===this.mode){if(!this.validateForm())return!1}else if(1==t&&!this.validateForm())return!1;if("step"===this.mode&&(this.cache.sections[this.currentStep].style.display="none"),this.currentStep=this.currentStep+t,this.currentStep>=this.cache.sections.length)return this.submitted=!0,this.showResults.call(this),!1;this.showTab.call(this,this.currentStep)}showResults(){let t=parseFloat(this.form.querySelector('[name="landToWork"').value),e=parseFloat(this.form.querySelector('[name="daysToWork"').value)||0,s=parseFloat(this.form.querySelector('[name="hoursPerDay"').value),i=a(e>0?e*s:s,2),r=a(t/i,2),o=a(r*s,2),n={socket:this.socket,tract:this.tract,units:this.units,landToWork:t,daysToWork:e,hoursPerDay:s,totalHours:i,fieldCapacityRequired:r,landWorkedPerDay:o,calculated:new Date};this.socket&&this.agcCalculated.emit({socket:this.socket,tract:this.tract,results:Object.assign({},n)}),this.results=Object.assign({},n),this.cache.results.forEach(t=>{t.style.display="block"})}handleAction(t){"reset"===t.detail.action&&this.reset()}componentDidLoad(){var t=Array.from(this.form.querySelectorAll("[data-wizard-section]")).map(t=>t).map(t=>t),e=Array.from(this.form.querySelectorAll("[data-wizard-results]")).map(t=>t).map(t=>t);this.cache=Object.assign({},this.cache,{sections:t,results:e}),window.document.addEventListener("agcAction",this.handleAction.bind(this)),this.showTab(0)}componentDidUnload(){window.document.removeEventListener("agcAction",this.handleAction)}static get is(){return"agc-field-capacity-required"}static get properties(){return{cache:{state:!0},currentStep:{state:!0},mode:{type:String,attr:"mode"},results:{state:!0},socket:{type:String,attr:"socket"},submitted:{state:!0},tract:{type:String,attr:"tract"},units:{type:"Any",attr:"units"}}}static get events(){return[{name:"agcCalculated",method:"agcCalculated",bubbles:!0,cancelable:!0,composed:!0},{name:"agcStepChanged",method:"agcStepChanged",bubbles:!0,cancelable:!0,composed:!0}]}}export{s as AgcFieldCapacityRequired};